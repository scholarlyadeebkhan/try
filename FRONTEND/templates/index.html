<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AarogyaLink - Your Personal Health Companion</title>
    <!-- Favicon and Google Fonts (Inter) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚕️</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Material Symbols CDN -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    

    
    <!-- Enhanced Features Scripts (Load Order Matters) -->
    <!-- 1. Main Enhanced Features Controller -->
    <script src="{{ url_for('static', filename='enhanced_features.js') }}"></script>
    
    <!-- 2. Language System -->
    <script src="{{ url_for('static', filename='js/language.js') }}"></script>
    
    <!-- 3. Floating CTA Button -->
    <script src="{{ url_for('static', filename='js/floating-cta.js') }}"></script>
    
    <!-- 4. Material 3 Enhanced Animations -->
    <script src="{{ url_for('static', filename='js/material3-animations.js') }}"></script>
    
    <!-- Floating Button Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/floating-button.css') }}">
    
    <!-- Custom Material 3 Styles -->
    <style>
        /* This is where the content of style.css will be */
        :root {
            /* ----- Material 3 Color Palette ----- */
            /* This palette is inspired by Material 3's baseline theme. */
        
            /* Primary Colors */
            --md-ref-palette-primary-40: #6750A4;
            --md-ref-palette-primary-90: #EADDFF;
            --md-ref-palette-primary-10: #21005D;
            --md-ref-palette-primary-80: #D0BCFF;
        
            /* Secondary Colors */
            --md-ref-palette-secondary-40: #625B71;
            --md-ref-palette-secondary-90: #E8DEF8;
            --md-ref-palette-secondary-10: #1D192B;
            --md-ref-palette-secondary-80: #CCC2DC;
        
            /* Tertiary Colors */
            --md-ref-palette-tertiary-40: #7D5260;
            --md-ref-palette-tertiary-90: #FFD8E4;
            --md-ref-palette-tertiary-10: #31111D;
            --md-ref-palette-tertiary-80: #EFB8C8;
        
            /* Neutral Colors (for surfaces and text) */
            --md-ref-palette-neutral-6: #1C1B1F;
            --md-ref-palette-neutral-10: #211F26;
            --md-ref-palette-neutral-20: #36343B;
            --md-ref-palette-neutral-30: #4C4956;
            --md-ref-palette-neutral-50: #7A7680;
            --md-ref-palette-neutral-90: #E6E1E5;
            --md-ref-palette-neutral-95: #F5EEF6;
            --md-ref-palette-neutral-99: #FFFBFE;
        
            /* Error Colors */
            --md-ref-palette-error-40: #BA1A1A;
            --md-ref-palette-error-90: #FFDAD6;
            --md-ref-palette-error-10: #410002;
            --md-ref-palette-error-80: #FFB4AB;
        }
        
        /* Light Theme Colors (default) */
        :root,
        html[data-theme="light"] {
            --md-sys-color-primary: var(--md-ref-palette-primary-40);
            --md-sys-color-on-primary: #FFFFFF;
            --md-sys-color-primary-container: var(--md-ref-palette-primary-90);
            --md-sys-color-on-primary-container: var(--md-ref-palette-primary-10);
        
            --md-sys-color-secondary: var(--md-ref-palette-secondary-40);
            --md-sys-color-on-secondary: #FFFFFF;
            --md-sys-color-secondary-container: var(--md-ref-palette-secondary-90);
            --md-sys-color-on-secondary-container: var(--md-ref-palette-secondary-10);
        
            --md-sys-color-tertiary: var(--md-ref-palette-tertiary-40);
            --md-sys-color-on-tertiary: #FFFFFF;
            --md-sys-color-tertiary-container: var(--md-ref-palette-tertiary-90);
            --md-sys-color-on-tertiary-container: var(--md-ref-palette-tertiary-10);
        
            --md-sys-color-surface: var(--md-ref-palette-neutral-99);
            --md-sys-color-on-surface: var(--md-ref-palette-neutral-10);
            --md-sys-color-surface-variant: var(--md-ref-palette-neutral-90);
            --md-sys-color-on-surface-variant: var(--md-ref-palette-neutral-30);
            --md-sys-color-surface-container: #F3EDF7;
            --md-sys-color-surface-container-low: #F7F2FA;
            --md-sys-color-surface-container-high: #ECE6F0;
        
            --md-sys-color-outline: var(--md-ref-palette-neutral-50);
            --md-sys-color-outline-variant: #CAC4D0;
            
            --md-sys-color-error: var(--md-ref-palette-error-40);
            --md-sys-color-on-error: #FFFFFF;
            --md-sys-color-error-container: var(--md-ref-palette-error-90);
            --md-sys-color-on-error-container: var(--md-ref-palette-error-10);
        }
        
        /* Dark Theme Colors */
        html[data-theme="dark"] {
            --md-sys-color-primary: #BB86FC;
            --md-sys-color-on-primary: #371E73;
            --md-sys-color-primary-container: #4F378B;
            --md-sys-color-on-primary-container: #EADDFF;
        
            --md-sys-color-secondary: #CCC2DC;
            --md-sys-color-on-secondary: #332D41;
            --md-sys-color-secondary-container: #4A4458;
            --md-sys-color-on-secondary-container: #E8DEF8;
        
            --md-sys-color-tertiary: #EFB8C8;
            --md-sys-color-on-tertiary: #492532;
            --md-sys-color-tertiary-container: #633B48;
            --md-sys-color-on-tertiary-container: #FFD8E4;
        
            --md-sys-color-surface: #1C1B1F;
            --md-sys-color-on-surface: #E6E1E5;
            --md-sys-color-surface-variant: #49454F;
            --md-sys-color-on-surface-variant: #CAC4D0;
            --md-sys-color-surface-container: #2B2930;
            --md-sys-color-surface-container-low: #211F26;
            --md-sys-color-surface-container-high: #36343B;
        
            --md-sys-color-outline: #938F99;
            --md-sys-color-outline-variant: #49454F;
            
            --md-sys-color-error: #F2B8B5;
            --md-sys-color-on-error: #601410;
            --md-sys-color-error-container: #8C1D18;
            --md-sys-color-on-error-container: #F9DEDC;
        }

        /* Add Product Sans Font */
        @font-face {
            font-family: 'Product Sans';
            font-style: normal;
            font-weight: 400;
            src: local('Product Sans Regular'), url(https://fonts.gstatic.com/s/productsans/v11/u-F-xXWPtlydF9G4F_Kj1w.woff2) format('woff2');
        }
        @font-face {
            font-family: 'Product Sans';
            font-style: normal;
            font-weight: 700;
            src: local('Product Sans Bold'), url(https://fonts.gstatic.com/s/productsans/v11/u-F2xXWPtlydF9G4F_Kj1w.woff2) format('woff2');
        }
        
        /* Enhanced Material 3 Smooth Transitions */
        * {
            transition: background-color 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94), 
                       color 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94), 
                       border-color 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94), 
                       box-shadow 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                       transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        /* Enhanced card animations */
        .m3-card:hover {
            transform: translateY(-6px) scale(1.02);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }
        
        /* Enhanced button animations */
        .m3-button {
            position: relative;
            overflow: hidden;
        }
        
        .m3-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(103, 80, 164, 0.3);
        }
        
        /* Page entrance animation */
        body {
            animation: pageEnter 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        @keyframes pageEnter {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Scroll-triggered animations */
        .fade-in-up {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .fade-in-up.animate {
            opacity: 1;
            transform: translateY(0);
        }
        
        body {
            background-color: var(--md-sys-color-surface);
            color: var(--md-sys-color-on-surface);
            font-family: 'Product Sans', 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Enhanced dark theme for cards */
        html[data-theme="dark"] .m3-card {
            background-color: var(--md-sys-color-surface-container);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }
        
        html[data-theme="dark"] .m3-card:hover {
            background-color: var(--md-sys-color-surface-container-high);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6);
        }
        
        /* Enhanced dark theme for buttons */
        html[data-theme="dark"] .m3-button {
            background-color: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary);
        }
        
        html[data-theme="dark"] .m3-button:hover {
            background-color: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-on-primary-container);
            box-shadow: 0 6px 20px rgba(187, 134, 252, 0.4);
        }
        
        /* Enhanced dark theme for footer */
        html[data-theme="dark"] footer {
            background-color: var(--md-sys-color-surface-container-low);
            color: var(--md-sys-color-on-surface);
        }
        
        /* Enhanced dark theme for inputs */
        html[data-theme="dark"] .m3-input {
            background-color: var(--md-sys-color-surface-container-low);
            border-color: var(--md-sys-color-outline);
            color: var(--md-sys-color-on-surface);
        }
        
        /* Enhanced dark theme for tabs */
        html[data-theme="dark"] .tab-container {
            border-bottom: 2px solid var(--md-sys-color-outline);
        }
        
        html[data-theme="dark"] .tab {
            color: var(--md-sys-color-on-surface-variant);
        }
        
        html[data-theme="dark"] .tab:hover {
            background-color: var(--md-sys-color-surface-container-high);
            color: var(--md-sys-color-on-surface);
        }
        
        html[data-theme="dark"] .tab.active {
            background-color: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-on-primary-container);
        }
        
        html[data-theme="dark"] .tab.active::after {
            background-color: var(--md-sys-color-primary);
        }
        
        html[data-theme="dark"] .m3-input:focus {
            border-color: var(--md-sys-color-primary);
            background-color: var(--md-sys-color-surface-container);
            box-shadow: 0 0 0 2px rgba(187, 134, 252, 0.25);
        }
        
        /* Enhanced dark theme for header */
        html[data-theme="dark"] header {
            background-color: var(--md-sys-color-surface-container-low);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }
        
        html[data-theme="dark"] header nav {
            background-color: var(--md-sys-color-surface-container-low);
        }
        
        html[data-theme="dark"] .navigation-links a {
            color: var(--md-sys-color-on-surface);
        }
        
        html[data-theme="dark"] .navigation-links a:hover {
            color: var(--md-sys-color-primary);
        }
        
        .brand-name {
            color: var(--md-sys-color-on-surface);
        }
        
        .brand-subtitle {
            color: var(--md-sys-color-on-surface-variant);
        }
        
        /* Enhanced dark theme for teachable machine elements */
        html[data-theme="dark"] .teachable-container .controls button {
            background-color: var(--md-sys-color-surface-container);
            color: var(--md-sys-color-on-surface);
            border: 1px solid var(--md-sys-color-outline);
        }
        
        html[data-theme="dark"] .teachable-container .controls button:hover {
            background-color: var(--md-sys-color-surface-container-high);
        }
        
        html[data-theme="dark"] .teachable-container #status {
            background-color: var(--md-sys-color-surface-container);
            color: var(--md-sys-color-on-surface);
            border: 1px solid var(--md-sys-color-outline);
        }
        
        html[data-theme="dark"] .prediction-item-horizontal {
            background-color: var(--md-sys-color-surface-container);
            border: 1px solid var(--md-sys-color-outline);
            color: var(--md-sys-color-on-surface);
        }
        
        html[data-theme="dark"] .prediction-item-horizontal:hover {
            background-color: var(--md-sys-color-surface-container-high);
        }
        
        html[data-theme="dark"] .radial-progress-text {
            color: var(--md-sys-color-on-surface);
        }
        
        /* Enhanced dark theme for chat messages */
        html[data-theme="dark"] .message-bubble {
            background-color: var(--md-sys-color-surface-container);
            color: var(--md-sys-color-on-surface);
            border: 1px solid var(--md-sys-color-outline);
        }
        
        html[data-theme="dark"] .message.user .message-bubble {
            background: linear-gradient(135deg, var(--md-sys-color-primary) 0%, var(--md-sys-color-primary-container) 100%);
            color: var(--md-sys-color-on-primary);
            border: 1px solid var(--md-sys-color-primary);
        }
        
        html[data-theme="dark"] .message.ai .message-bubble {
            background-color: var(--md-sys-color-surface-container);
            color: var(--md-sys-color-on-surface);
            border: 1px solid var(--md-sys-color-outline);
        }
        
        html[data-theme="dark"] .m3-input::placeholder {
            color: var(--md-sys-color-on-surface-variant);
        }
        
        /* Language Switcher Styles */
        .language-switcher {
            position: relative;
            display: inline-block;
        }
        
        .language-toggle {
            background: var(--md-sys-color-surface-container);
            border: 1px solid var(--md-sys-color-outline);
            border-radius: 50px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            min-width: 140px;
        }
        
        .language-toggle:hover {
            background: var(--md-sys-color-surface-container-high);
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        }
        
        .language-toggle .material-symbols-outlined {
            font-size: 20px;
            color: var(--md-sys-color-on-surface);
        }
        
        .language-text {
            font-size: 14px;
            font-weight: 500;
            color: var(--md-sys-color-on-surface);
            flex: 1;
        }
        
        .dropdown-arrow {
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .language-toggle.active .dropdown-arrow {
            transform: rotate(180deg);
        }
        
        .language-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--md-sys-color-surface-container);
            border: 1px solid var(--md-sys-color-outline);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(20px);
            z-index: 1000;
            margin-top: 8px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px) scale(0.95);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .language-dropdown.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0) scale(1);
        }
        
        .language-option {
            width: 100%;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--md-sys-color-on-surface);
            font-size: 14px;
            font-weight: 500;
        }
        
        .language-option:first-child {
            border-radius: 16px 16px 0 0;
        }
        
        .language-option:last-child {
            border-radius: 0 0 16px 16px;
        }
        
        .language-option:hover {
            background: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-on-primary-container);
        }
        
        .language-option.active {
            background: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary);
        }
        
        .language-option .flag {
            font-size: 18px;
        }
        
        /* Dark theme adjustments */
        html[data-theme="dark"] .language-toggle {
            background: var(--md-sys-color-surface-container);
            border-color: var(--md-sys-color-outline);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        html[data-theme="dark"] .language-dropdown {
            background: var(--md-sys-color-surface-container);
            border-color: var(--md-sys-color-outline);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }
        
        html[data-theme="dark"] .language-toggle .material-symbols-outlined,
        html[data-theme="dark"] .language-text {
            color: var(--md-sys-color-on-surface);
        }
        
        /* Dark Theme Toggle Button */
        .theme-toggle {
            background: var(--md-sys-color-surface-container);
            border: 1px solid var(--md-sys-color-outline);
            border-radius: 50px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .theme-toggle:hover {
            background: var(--md-sys-color-surface-container-high);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .theme-toggle .material-symbols-outlined {
            font-size: 20px;
            color: var(--md-sys-color-on-surface);
        }
        
        .theme-toggle-text {
            font-size: 14px;
            font-weight: 500;
            color: var(--md-sys-color-on-surface);
        }
        
        /* Dark theme adjustments for theme toggle */
        html[data-theme="dark"] .theme-toggle {
            background: var(--md-sys-color-surface-container);
            border-color: var(--md-sys-color-outline);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        html[data-theme="dark"] .theme-toggle:hover {
            background: var(--md-sys-color-surface-container-high);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }
        
        html[data-theme="dark"] .theme-toggle .material-symbols-outlined,
        html[data-theme="dark"] .theme-toggle-text {
            color: var(--md-sys-color-on-surface);
        }
        
        /* Material 3 Typography Scale */
        h1, h2 {
            font-family: 'Product Sans', sans-serif;
            font-weight: 700;
        }

        h1 {
            font-size: 3rem;
            line-height: 1.25;
        }
        
        h2 {
            font-size: 2.5rem;
            line-height: 1.25;
        }
        
        h3 {
            font-size: 1.5rem;
            line-height: 1.5;
            font-weight: 600;
        }
        
        /* Component Styles */
        .m3-card {
            background-color: var(--md-sys-color-surface-container);
            border-radius: 28px;
            box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15), 0px 1px 2px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s cubic-bezier(0.2, 0, 0, 1), box-shadow 0.2s cubic-bezier(0.2, 0, 0, 1), background-color 0.3s ease;
        }
        
        [data-theme="dark"] .m3-card {
            box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.25), 0px 1px 2px rgba(0, 0, 0, 0.4);
        }
        
        .m3-card:hover {
            transform: scale(1.02);
            box-shadow: 0px 5px 10px rgba(0, 0, 0, 0.2);
            background-color: var(--md-sys-color-surface-container-high);
        }
        
        [data-theme="dark"] .m3-card:hover {
            box-shadow: 0px 5px 10px rgba(0, 0, 0, 0.4);
        }
        
        .m3-button {
            background-color: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary);
            border-radius: 100px;
            font-weight: 500;
            transition: background-color 0.2s cubic-bezier(0.2, 0, 0, 1), transform 0.2s cubic-bezier(0.2, 0, 0, 1);
            border: none;
        }
        .m3-button:hover {
            background-color: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-on-primary-container);
            transform: translateY(-2px);
        }
        
        .m3-input {
            background-color: var(--md-sys-color-surface-container-low);
            border: 1px solid var(--md-sys-color-outline-variant);
            border-radius: 4px;
            padding: 12px;
            color: var(--md-sys-color-on-surface);
            transition: border-color 0.2s ease, box-shadow 0.2s ease, background-color 0.3s ease;
        }
        .m3-input:focus {
            border-color: var(--md-sys-color-primary);
            outline: none;
            box-shadow: 0 0 0 2px rgba(103, 80, 164, 0.25);
            background-color: var(--md-sys-color-surface-container);
        }
        
        .m3-input::placeholder {
            color: var(--md-sys-color-on-surface-variant);
        }
        
        /* Material Symbols Integration */
        .material-symbols-outlined {
            font-family: 'Material Symbols Outlined';
            font-weight: normal;
            font-style: normal;
            font-size: 24px;
            line-height: 1;
            letter-spacing: normal;
            text-transform: none;
            display: inline-block;
            white-space: nowrap;
            word-wrap: normal;
            direction: ltr;
        }

        /* Enhanced Chat Interface Styles with Material 3 Textbox Design */
        .chat-container {
            max-height: 450px;
            overflow-y: auto;
            padding: 16px;
            background: linear-gradient(to bottom, transparent 0%, var(--md-sys-color-surface-container-low) 100%);
            border-radius: 16px;
            margin-bottom: 24px;
        }
        
        .message {
            margin-bottom: 20px;
            animation: slideInUp 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        
        .message.user {
            flex-direction: row-reverse;
            justify-content: flex-start;
        }
        
        .message.ai {
            flex-direction: row;
        }
        
        /* Avatar/Icon Styles */
        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 18px;
            font-weight: 600;
            transition: transform 0.2s ease;
        }
        
        .message.user .message-avatar {
            background: linear-gradient(135deg, var(--md-sys-color-primary) 0%, var(--md-sys-color-secondary) 100%);
            color: var(--md-sys-color-on-primary);
            box-shadow: 0 4px 12px rgba(103, 80, 164, 0.3);
        }
        
        .message.ai .message-avatar {
            background: linear-gradient(135deg, var(--md-sys-color-tertiary) 0%, var(--md-sys-color-primary) 100%);
            color: var(--md-sys-color-on-tertiary);
            box-shadow: 0 4px 12px rgba(125, 82, 96, 0.3);
        }
        
        .message-avatar:hover {
            transform: scale(1.1);
        }
        
        /* Enhanced Message Bubble with Textbox Shape */
        .message-bubble {
            max-width: 75%;
            padding: 16px 20px;
            border-radius: 20px;
            word-wrap: break-word;
            line-height: 1.6;
            font-size: 15px;
            position: relative;
            backdrop-filter: blur(10px);
            border: 1px solid var(--md-sys-color-outline-variant);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .message.user .message-bubble {
            background: linear-gradient(135deg, var(--md-sys-color-primary) 0%, var(--md-sys-color-primary-container) 100%);
            color: var(--md-sys-color-on-primary);
            border-bottom-right-radius: 6px;
            border: 1px solid var(--md-sys-color-primary);
            box-shadow: 0 4px 16px rgba(103, 80, 164, 0.25);
        }
        
        .message.ai .message-bubble {
            background: var(--md-sys-color-surface-container);
            color: var(--md-sys-color-on-surface);
            border-bottom-left-radius: 6px;
            border: 1px solid var(--md-sys-color-outline-variant);
        }
        
        .message-bubble:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }
        
        /* Message Bubble Tail Effect */
        .message-bubble::before {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border: 8px solid transparent;
        }
        
        .message.user .message-bubble::before {
            right: -15px;
            bottom: 8px;
            border-left-color: var(--md-sys-color-primary);
            border-right: none;
        }
        
        .message.ai .message-bubble::before {
            left: -15px;
            bottom: 8px;
            border-right-color: var(--md-sys-color-surface-container);
            border-left: none;
        }
        
        /* Typing indicator */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 8px 0;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--md-sys-color-primary);
            animation: typingPulse 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typingPulse {
            0%, 60%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            30% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        @keyframes slideInUp {
            from { 
                opacity: 0; 
                transform: translateY(20px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
        
        .loading {
            opacity: 0.7;
        }
        
        .file-upload-area {
            border: 2px dashed var(--md-sys-color-outline-variant);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            background-color: var(--md-sys-color-surface-container-low);
            transition: border-color 0.2s ease, background-color 0.3s ease;
        }
        
        .file-upload-area.dragover {
            border-color: var(--md-sys-color-primary);
            background-color: var(--md-sys-color-primary-container);
        }
        
        /* Dark theme adjustments for file upload area */
        html[data-theme="dark"] .file-upload-area {
            border-color: var(--md-sys-color-outline-variant);
            background-color: var(--md-sys-color-surface-container-low);
        }
        
        html[data-theme="dark"] .file-upload-area.dragover {
            border-color: var(--md-sys-color-primary);
            background-color: var(--md-sys-color-primary-container);
        }
        
        /* Tab Styles */
        .tab-container {
            display: flex;
            border-bottom: 2px solid var(--md-sys-color-outline);
            margin-bottom: 24px;
        }
        
        .tab {
            flex: 1;
            padding: 16px 24px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: transparent;
            color: var(--md-sys-color-on-surface-variant);
            font-weight: 500;
            transition: all 0.3s cubic-bezier(0.2, 0, 0, 1);
            position: relative;
            border-radius: 12px 12px 0 0;
        }
        
        .tab:hover {
            background-color: var(--md-sys-color-surface-variant);
            color: var(--md-sys-color-on-surface);
        }
        
        .tab.active {
            background-color: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-primary);
            font-weight: 600;
        }
        
        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background-color: var(--md-sys-color-primary);
        }
        
        .tab-content {
            display: none;
            animation: fadeInUp 0.3s ease-out;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .tab-icon {
            display: block;
            font-size: 28px !important;
            margin-bottom: 8px;
        }
        
        .enhanced-input-area {
            background: linear-gradient(135deg, var(--md-sys-color-surface-container) 0%, var(--md-sys-color-surface-container-low) 100%);
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }
        
        [data-theme="dark"] .enhanced-input-area {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }
        
        .voice-recording {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            min-height: 200px;
            border: 2px dashed var(--md-sys-color-outline-variant);
            border-radius: 16px;
            background: var(--md-sys-color-surface-container-low);
            transition: all 0.3s ease;
        }
        
        .voice-recording.recording {
            border-color: var(--md-sys-color-error);
            background: var(--md-sys-color-error-container);
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        /* Dark theme adjustments for voice recording */
        html[data-theme="dark"] .voice-recording {
            border-color: var(--md-sys-color-outline-variant);
            background: var(--md-sys-color-surface-container-low);
        }
        
        html[data-theme="dark"] .voice-recording.recording {
            border-color: var(--md-sys-color-error);
            background: var(--md-sys-color-error-container);
        }
        
        .image-preview {
            max-width: 100%;
            max-height: 300px;
            border-radius: 12px;
            margin-top: 16px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* Dark theme adjustments for image preview */
        html[data-theme="dark"] .image-preview {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .input-with-send {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }
        
        .input-buttons {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        /* Dark theme adjustments for input with send */
        html[data-theme="dark"] .input-with-send {
            background-color: var(--md-sys-color-surface-container-low);
        }
        
        .voice-button {
            background: var(--md-sys-color-secondary);
            color: var(--md-sys-color-on-secondary);
            border: none;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.2, 0, 0, 1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .voice-button:hover {
            background: var(--md-sys-color-secondary-container);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .voice-button.recording {
            background: var(--md-sys-color-error);
            color: var(--md-sys-color-on-error);
            animation: pulse 1.5s infinite;
        }
        
        .voice-button.recording .material-symbols-outlined {
            animation: pulse 1s infinite;
        }
        
        /* Dark theme adjustments for voice button */
        html[data-theme="dark"] .voice-button {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        html[data-theme="dark"] .voice-button:hover {
            background: var(--md-sys-color-secondary-container);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
        }
        
        html[data-theme="dark"] .voice-button.recording {
            box-shadow: 0 2px 8px rgba(242, 184, 181, 0.4);
        }
        
        .enhanced-textarea {
            flex: 1;
            min-height: 120px;
            resize: vertical;
            font-size: 16px;
            line-height: 1.5;
        }
        
        /* Dark theme adjustments for enhanced textarea */
        html[data-theme="dark"] .enhanced-textarea {
            background-color: var(--md-sys-color-surface-container-low);
            border-color: var(--md-sys-color-outline-variant);
            color: var(--md-sys-color-on-surface);
        }
        
        html[data-theme="dark"] .enhanced-textarea:focus {
            border-color: var(--md-sys-color-primary);
            background-color: var(--md-sys-color-surface-container);
            box-shadow: 0 0 0 2px rgba(187, 134, 252, 0.25);
        }
        
        html[data-theme="dark"] .enhanced-textarea::placeholder {
            color: var(--md-sys-color-on-surface-variant);
        }
        
        .send-button {
            background: linear-gradient(135deg, var(--md-sys-color-primary) 0%, #553E87 100%);
            color: var(--md-sys-color-on-primary);
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.2, 0, 0, 1);
            box-shadow: 0 4px 12px rgba(103, 80, 164, 0.3);
        }
        
        .send-button:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 16px rgba(103, 80, 164, 0.4);
        }
        
        .send-button:active {
            transform: translateY(0) scale(0.95);
        }
        
        /* Dark theme adjustments for send button */
        html[data-theme="dark"] .send-button {
            box-shadow: 0 4px 12px rgba(187, 134, 252, 0.4);
        }
        
        html[data-theme="dark"] .send-button:hover {
            box-shadow: 0 6px 16px rgba(187, 134, 252, 0.5);
        }
        
        /* Theme toggle button styles */
        html[data-theme="dark"] .theme-toggle {
            background: var(--md-sys-color-surface-container);
            border-color: var(--md-sys-color-outline);
        }
        
        html[data-theme="dark"] .theme-toggle:hover {
            background: var(--md-sys-color-surface-container-high);
        }
        
        /* Enhanced dark theme for file upload area */
        html[data-theme="dark"] .file-upload-area {
            background: var(--md-sys-color-surface-container-low);
            border-color: var(--md-sys-color-outline-variant);
        }
        
        /* Enhanced dark theme for input with send */
        html[data-theme="dark"] .input-with-send {
            background: var(--md-sys-color-surface-container-low);
        }
        
        /* Enhanced dark theme for enhanced textarea */
        html[data-theme="dark"] .enhanced-textarea {
            background: var(--md-sys-color-surface-container-low);
            border-color: var(--md-sys-color-outline-variant);
            color: var(--md-sys-color-on-surface);
        }
        
        html[data-theme="dark"] .enhanced-textarea:focus {
            border-color: var(--md-sys-color-primary);
            background: var(--md-sys-color-surface-container);
            box-shadow: 0 0 0 2px rgba(187, 134, 252, 0.25);
        }
        
        html[data-theme="dark"] .enhanced-textarea::placeholder {
            color: var(--md-sys-color-on-surface-variant);
        }
        
        /* Enhanced dark theme for voice button */
        html[data-theme="dark"] .voice-button {
            background: var(--md-sys-color-secondary);
            color: var(--md-sys-color-on-secondary);
        }
        
        html[data-theme="dark"] .voice-button:hover {
            background: var(--md-sys-color-secondary-container);
            color: var(--md-sys-color-on-secondary-container);
        }
        
        html[data-theme="dark"] .voice-button.recording {
            background: var(--md-sys-color-error);
            color: var(--md-sys-color-on-error);
        }
        
        /* Enhanced dark theme for tab container */
        html[data-theme="dark"] .tab-container {
            border-bottom-color: var(--md-sys-color-outline);
        }
        
        html[data-theme="dark"] .tab {
            color: var(--md-sys-color-on-surface-variant);
        }
        
        html[data-theme="dark"] .tab:hover {
            background: var(--md-sys-color-surface-container-high);
            color: var(--md-sys-color-on-surface);
        }
        
        html[data-theme="dark"] .tab.active {
            background: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-on-primary-container);
        }
        
        html[data-theme="dark"] .tab.active::after {
            background: var(--md-sys-color-primary);
        }

        /* Teachable Machine Webcam Styles */
        .webcam-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            padding: 24px;
            border-radius: 16px;
            background: var(--md-sys-color-surface-container-low);
            border: 2px solid var(--md-sys-color-outline-variant);
        }
        
        .webcam-canvas {
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            max-width: 100%;
            height: auto;
        }
        
        /* Dark theme adjustments for webcam container */
        html[data-theme="dark"] .webcam-container {
            background: var(--md-sys-color-surface-container-low);
            border-color: var(--md-sys-color-outline-variant);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        html[data-theme="dark"] .webcam-canvas {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .prediction-container {
            width: 100%;
            max-width: 400px;
        }
        
        .prediction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            margin: 8px 0;
            border-radius: 12px;
            background: var(--md-sys-color-surface-container);
            border: 1px solid var(--md-sys-color-outline-variant);
        }
        
        .prediction-label {
            font-weight: 500;
            color: var(--md-sys-color-on-surface);
        }
        
        .prediction-confidence {
            font-weight: 600;
            color: var(--md-sys-color-primary);
        }
        
        .prediction-bar {
            width: 100%;
            height: 8px;
            background: var(--md-sys-color-surface-variant);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }
        
        .prediction-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--md-sys-color-primary) 0%, var(--md-sys-color-secondary) 100%);
            transition: width 0.3s ease;
        }
        
        /* Dark theme adjustments for prediction item */
        html[data-theme="dark"] .prediction-item {
            background: var(--md-sys-color-surface-container);
            border-color: var(--md-sys-color-outline-variant);
        }
        
        html[data-theme="dark"] .prediction-label {
            color: var(--md-sys-color-on-surface);
        }
        
        html[data-theme="dark"] .prediction-confidence {
            color: var(--md-sys-color-primary);
        }
        
        html[data-theme="dark"] .prediction-bar {
            background: var(--md-sys-color-surface-variant);
        }
        

        
        /* Enhanced Chat Interface Styles with Textbox Shapes */
        .chat-container {
            max-height: 500px;
            overflow-y: auto;
            padding: 16px;
            scroll-behavior: smooth;
        }
        
        /* Dark theme adjustments for chat container */
        html[data-theme="dark"] .chat-container {
            background: linear-gradient(to bottom, transparent 0%, var(--md-sys-color-surface-container-low) 100%);
        }
        
        .message {
            margin-bottom: 20px;
            animation: messageSlideIn 0.4s cubic-bezier(0.2, 0, 0, 1);
            display: flex;
            align-items: flex-end;
            gap: 12px;
        }
        
        .message.user {
            justify-content: flex-end;
        }
        
        .message.ai {
            justify-content: flex-start;
        }
        
        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .message.user .message-avatar {
            background: linear-gradient(135deg, var(--md-sys-color-primary) 0%, var(--md-sys-color-secondary) 100%);
            color: var(--md-sys-color-on-primary);
            order: 2;
        }
        
        .message.ai .message-avatar {
            background: linear-gradient(135deg, var(--md-sys-color-tertiary) 0%, var(--md-sys-color-primary) 100%);
            color: var(--md-sys-color-on-tertiary);
        }
        
        .message-bubble {
            max-width: 75%;
            padding: 16px 20px;
            border-radius: 24px;
            word-wrap: break-word;
            font-size: 15px;
            line-height: 1.5;
            position: relative;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s cubic-bezier(0.2, 0, 0, 1);
        }
        
        .message.user .message-bubble {
            background: linear-gradient(135deg, var(--md-sys-color-primary) 0%, #553E87 100%);
            color: var(--md-sys-color-on-primary);
            border-bottom-right-radius: 8px;
            margin-right: 8px;
        }
        
        .message.user .message-bubble::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: -8px;
            width: 0;
            height: 0;
            border: 8px solid transparent;
            border-left-color: var(--md-sys-color-primary);
            border-bottom: none;
        }
        
        .message.ai .message-bubble {
            background: var(--md-sys-color-surface-container-high);
            color: var(--md-sys-color-on-surface);
            border: 1px solid var(--md-sys-color-outline-variant);
            border-bottom-left-radius: 8px;
            margin-left: 8px;
        }
        
        .message.ai .message-bubble::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: -9px;
            width: 0;
            height: 0;
            border: 8px solid transparent;
            border-right-color: var(--md-sys-color-surface-container-high);
            border-bottom: none;
        }
        
        .message-bubble:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        }
        
        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        /* Language Switcher Styles */
        .language-switcher {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--md-sys-color-surface-container);
            border: 1px solid var(--md-sys-color-outline-variant);
            border-radius: 50px;
            padding: 8px 16px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.2, 0, 0, 1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            position: relative;
        }
        
        .language-switcher:hover {
            background: var(--md-sys-color-surface-container-high);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .language-switcher .material-symbols-outlined {
            font-size: 20px;
            color: var(--md-sys-color-on-surface);
        }
        
        .language-text {
            font-size: 14px;
            font-weight: 500;
            color: var(--md-sys-color-on-surface);
        }
        
        .language-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: var(--md-sys-color-surface-container);
            border: 1px solid var(--md-sys-color-outline-variant);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(20px);
            padding: 8px;
            min-width: 160px;
            z-index: 1000;
            opacity: 0;
            transform: translateY(-10px) scale(0.95);
            transition: all 0.3s cubic-bezier(0.2, 0, 0, 1);
            pointer-events: none;
        }
        
        .language-dropdown.show {
            opacity: 1;
            transform: translateY(0) scale(1);
            pointer-events: all;
        }
        
        .language-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.2, 0, 0, 1);
            font-size: 14px;
            font-weight: 500;
            border: none;
            background: transparent;
            width: 100%;
            text-align: left;
        }
        
        .language-option:hover {
            background: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-on-primary-container);
            transform: scale(1.02);
        }
        
        .language-option.active {
            background: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary);
        }
        
        .language-flag {
            font-size: 18px;
        }
        
        /* Floating Get Started Button */
        .floating-cta {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            background: linear-gradient(135deg, var(--md-sys-color-primary) 0%, #553E87 100%);
            color: var(--md-sys-color-on-primary);
            border: none;
            border-radius: 50px;
            padding: 16px 24px;
            font-size: 16px;
            font-weight: 600;
            box-shadow: 0 8px 32px rgba(103, 80, 164, 0.3);
            backdrop-filter: blur(10px);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.4s cubic-bezier(0.2, 0, 0, 1);
            transform: translateY(0);
            opacity: 0;
            animation: floatIn 0.6s cubic-bezier(0.2, 0, 0, 1) 1s forwards;
            text-decoration: none;
        }
        
        .floating-cta:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 0 12px 40px rgba(103, 80, 164, 0.4);
            text-decoration: none;
            color: var(--md-sys-color-on-primary);
        }
        
        .floating-cta:active {
            transform: translateY(-2px) scale(1.02);
        }
        
        .floating-cta .material-symbols-outlined {
            font-size: 20px;
            animation: pulse 2s infinite;
        }
        
        @keyframes floatIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        /* Hide floating button when chat section is visible */
        .floating-cta.hidden {
            opacity: 0;
            transform: translateY(20px) scale(0.8);
            pointer-events: none;
        }
        
        /* Floating Image Diagnosis Button */
        .floating-image-diagnosis {
            position: fixed;
            bottom: 30px;
            left: 30px;
            z-index: 1000;
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 16px 24px;
            font-size: 16px;
            font-weight: 600;
            letter-spacing: 0.5px;
            cursor: pointer;
            box-shadow: 0 8px 32px rgba(76, 175, 80, 0.4);
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            opacity: 0;
            animation: floatIn 0.6s cubic-bezier(0.2, 0, 0, 1) 1.5s forwards;
        }
        
        .floating-image-diagnosis:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 0 12px 40px rgba(76, 175, 80, 0.5);
            text-decoration: none;
            color: white;
        }
        
        .floating-image-diagnosis:active {
            transform: translateY(-2px) scale(1.02);
        }
        
        .floating-image-diagnosis .material-symbols-outlined {
            font-size: 20px;
            animation: pulse 2s infinite;
        }
        
        /* Mobile adjustments for floating image diagnosis button */
        @media (max-width: 768px) {
            .floating-image-diagnosis {
                bottom: 24px;
                left: 24px;
                padding: 14px 20px;
                font-size: 14px;
            }
        }
    </style>
</head>

<body class="scroll-smooth" style="background-color: var(--md-sys-color-surface); color: var(--md-sys-color-on-surface);">

    <!-- Section 1: Navigation Bar -->
    <header class="bg-white/90 backdrop-blur-md sticky top-0 z-50 shadow-sm" style="background-color: var(--md-sys-color-surface-container-low); backdrop-filter: blur(10px);">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <!-- Logo and Brand Name -->
            <a href="#hero" class="flex items-center space-x-2">
                <img src="/static/logo.jpg" alt="AarogyaLink Logo" class="h-8 w-8 rounded-full">
                <div>
                    <span class="font-bold text-lg block brand-name">AarogyaLink</span>
                    <span class="text-xs brand-subtitle">Your Personal Health Companion</span>
                </div>
            </a>
            
            <!-- Navigation Links -->
            <div class="hidden md:flex space-x-8 text-[var(--md-sys-color-on-surface-variant)] navigation-links">
                <a href="#how-it-works" class="hover:text-[var(--md-sys-color-on-surface)] transition-colors duration-200">How It Works</a>
                <a href="#chat" class="hover:text-[var(--md-sys-color-on-surface)] transition-colors duration-200">Try Now</a>
                <a href="#why-us" class="hover:text-[var(--md-sys-color-on-surface)] transition-colors duration-200">Why Us</a>
                <a href="#contact" class="hover:text-[var(--md-sys-color-on-surface)] transition-colors duration-200">Contact</a>
            </div>

            <!-- Theme Toggle and Language Switcher and CTA Button -->
            <div class="flex items-center space-x-4">
                <!-- Language Switcher -->
                <div class="language-switcher" onclick="toggleLanguageDropdown()">
                    <span class="material-symbols-outlined">language</span>
                    <span class="language-text" id="currentLanguage">English</span>
                    <span class="material-symbols-outlined">keyboard_arrow_down</span>
                    <div class="language-dropdown" id="languageDropdown">
                        <button onclick="changeLanguage('en')" class="language-option active" data-lang="en">
                            <span class="language-flag">🇺🇸</span>
                            <span>English</span>
                        </button>
                        <button onclick="changeLanguage('hi')" class="language-option" data-lang="hi">
                            <span class="language-flag">🇮🇳</span>
                            <span>हिंदी</span>
                        </button>
                        <button onclick="changeLanguage('pa')" class="language-option" data-lang="pa">
                            <span class="language-flag">🇮🇳</span>
                            <span>ਪੰਜਾਬੀ</span>
                        </button>
                        <button onclick="changeLanguage('or')" class="language-option" data-lang="or">
                            <span class="language-flag">🇮🇳</span>
                            <span>ଓଡ଼ିଆ</span>
                        </button>
                    </div>
                </div>
                
                <!-- Theme Toggle Button -->
                <button onclick="toggleTheme()" class="theme-toggle">
                    <span class="material-symbols-outlined" id="themeIcon">dark_mode</span>
                    <span class="theme-toggle-text" id="themeText">Dark</span>
                </button>
                
                <!-- CTA Button -->
                <a href="#chat" class="m3-button px-6 py-2 shadow-lg">
                    Get Started
                </a>
            </div>
        </nav>
    </header>

    <!-- Section 2: Hero Section -->
    <section id="hero" class="relative bg-[var(--md-sys-color-surface)] py-20 md:py-32">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col-reverse md:flex-row items-center justify-between">
            <!-- Left Side: Content -->
            <div class="w-full md:w-1/2 mt-12 md:mt-0">
                <h1 class="text-[var(--md-sys-color-on-surface)] text-5xl md:text-6xl font-bold" style="font-size: 2.2em; font-weight: 800;">
                    Your Personal Health Companion
                </h1>
                <p class="mt-4 text-lg text-[var(--md-sys-color-on-surface-variant)] max-w-lg">
                    Connect with care, whenever you need it. Securely share your health concerns and receive expert guidance, all in one place.
                </p>
                <a href="#chat" class="mt-8 inline-block px-8 py-4 text-lg m3-button shadow-lg text-2xl font-bold" style="font-size: 2.2em; font-weight: 700;">
                    Try Now
                </a>
            </div>

            <!-- Right Side: Image -->
            <div class="w-full md:w-1/2 flex justify-center md:justify-end">
                <div class="w-full h-80 rounded-[28px] overflow-hidden m3-card flex items-center justify-center" style="background-color: var(--md-sys-color-surface-container);">
                    <img src="/static/bodyimage.png" alt="Healthcare" class="w-full h-full object-cover">
                </div>
            </div>
        </div>
    </section>

    <!-- Section 3: How It Works -->
    <section id="how-it-works" class="py-20 md:py-32 bg-[var(--md-sys-color-surface-variant)]">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="text-[var(--md-sys-color-on-surface)] text-4xl md:text-5xl font-bold" style="font-size: 2.2em; font-weight: 800;">
                Connect with Care, Your Way.
            </h2>
            <p class="mt-4 text-lg text-[var(--md-sys-color-on-surface-variant)] max-w-2xl mx-auto">
                Our platform makes it simple to share your health concerns using any format you're comfortable with.
            </p>
        </div>
    </section>

    <!-- Section 5: Contact Us -->
    <section id="contact" class="py-20 md:py-32 bg-[var(--md-sys-color-surface-variant)]">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="text-[var(--md-sys-color-on-surface)]">Get in Touch</h2>
            <p class="mt-4 text-lg text-[var(--md-sys-color-on-surface-variant)] max-w-2xl mx-auto">
                If you have any questions or need assistance, feel free to reach out to us. We're here to help!
            </p>
            <form class="mt-8 flex flex-col space-y-4">
                <input type="text" placeholder="Your Name" class="px-4 py-2 border rounded-lg" />
                <input type="email" placeholder="Your Email" class="px-4 py-2 border rounded-lg" />
                <textarea placeholder="Your Message" class="px-4 py-2 border rounded-lg"></textarea>
                <button type="submit" class="px-8 py-4 m3-button shadow-lg">
                    Send Message
                </button>
            </form>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-8 bg-[var(--md-sys-color-surface)]">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p class="text-[var(--md-sys-color-on-surface-variant)]">
                © 2023 Your Company. All rights reserved.
            </p>
            </p>

            <div class="mt-16 grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Card 1: Text Input -->
                <div class="p-8 transform transition-transform duration-200 m3-card">
                    <span class="material-symbols-outlined text-[var(--md-sys-color-primary)] text-[48px]">edit</span>
                    <h3 class="mt-6 text-[var(--md-sys-color-on-surface)]">Describe Your Symptoms</h3>
                    <p class="mt-2 text-[var(--md-sys-color-on-surface-variant)]">
                        Simply type out what's on your mind. Our platform uses your words to connect you with the right support.
                    </p>
                </div>

                <!-- Card 2: Image Input -->
                <div class="p-8 transform transition-transform duration-200 m3-card">
                    <span class="material-symbols-outlined text-[var(--md-sys-color-primary)] text-[48px]">camera</span>
                    <h3 class="mt-6 text-[var(--md-sys-color-on-surface)]">Share a Photo</h3>
                    <p class="mt-2 text-[var(--md-sys-color-on-surface-variant)]">
                        Sometimes, a picture tells the whole story. Snap a photo of a rash, injury, or prescription for a visual consultation.
                    </p>
                </div>

                <!-- Card 3: Audio Input -->
                <div class="p-8 transform transition-transform duration-200 m3-card">
                    <span class="material-symbols-outlined text-[var(--md-sys-color-primary)] text-[48px]">mic</span>
                    <h3 class="mt-6 text-[var(--md-sys-color-on-surface)]">Record a Quick Message</h3>
                    <p class="mt-2 text-[var(--md-sys-color-on-surface-variant)]">
                        Can't type? Just record a voice message and our experts will listen and respond.
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Section 4: Interactive Chat Interface with Tabs -->
    <section id="chat" class="py-20 md:py-32">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-[var(--md-sys-color-on-surface)] text-4xl md:text-5xl font-bold" style="font-size: 2.2em; font-weight: 800;">
                    Try AarogyaLink Now
                </h2>
                <p class="mt-4 text-lg text-[var(--md-sys-color-on-surface-variant)]">
                    Share your health concerns in the way that works best for you
                </p>
            </div>

            <div class="m3-card p-8">
                <!-- Chat Messages -->
                <div id="chatContainer" class="chat-container mb-8">
                    <div class="message ai">
                        <div class="message-avatar">
                            <span class="material-symbols-outlined">health_and_safety</span>
                        </div>
                        <div class="message-bubble">
                            <div id="welcomeMessage">
                                Hi! I'm Dr. AarogyaLink, your AI health buddy. Tell me what's bothering you and I'll ask a few quick questions to help out. 😊
                                <br><br>
                                <em>Remember: For serious concerns, always see a real doctor!</em>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab Navigation -->
                <div class="tab-container">
                    <button class="tab active" onclick="switchTab('type')">
                        <span class="material-symbols-outlined tab-icon">edit</span>
                        Type Your Problem Here
                    </button>
                </div>

                <!-- Tab Content -->
                <div class="tab-content-container">
                    <!-- Type Tab -->
                    <div id="type-tab" class="tab-content active">
                        <div class="enhanced-input-area">
                            <div class="input-with-send">
                                <textarea id="messageInput" 
                                         placeholder="Please describe your symptoms in detail... For example: 'I have a severe headache that started this morning. It's throbbing and located on the right side of my head. I also feel nauseous.'" 
                                         class="enhanced-textarea m3-input"
                                         onkeydown="handleTextareaKeyPress(event)"></textarea>
                                <div class="input-buttons">
                                    <button id="voiceInputBtn" onclick="toggleVoiceInput()" class="voice-button" title="Click to speak">
                                        <span class="material-symbols-outlined">mic</span>
                                    </button>
                                    <button onclick="sendTextMessage()" class="send-button">
                                        <span class="material-symbols-outlined">send</span>
                                    </button>
                                </div>
                            </div>
                            <div class="mt-4 text-sm text-[var(--md-sys-color-on-surface-variant)]">
                                💡 <strong>Quick tip:</strong> Include when it started, pain level (1-10), and what makes it better/worse
                            </div>
                            
                            <!-- Quick Prompt Buttons REMOVED as per user request -->
                        </div>
                    </div>
                                        🤒 Fever
                                    </button>
                                    <button onclick="setQuickPrompt('stomach')" class="px-3 py-2 text-xs bg-gray-100 hover:bg-gray-200 rounded-full transition-colors">
                                        😷 Stomach Pain
                                    </button>
                                    <button onclick="setQuickPrompt('cough')" class="px-3 py-2 text-xs bg-gray-100 hover:bg-gray-200 rounded-full transition-colors">
                                        😷 Cough/Cold
                                    </button>
                                    <button onclick="setQuickPrompt('fatigue')" class="px-3 py-2 text-xs bg-gray-100 hover:bg-gray-200 rounded-full transition-colors">
                                        😴 Fatigue
                                    </button>
                                    <button onclick="setQuickPrompt('injury')" class="px-3 py-2 text-xs bg-gray-100 hover:bg-gray-200 rounded-full transition-colors">
                                        🤕 Injury/Pain
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                                <div id="uploaded-image-container" class="flex justify-center my-4">
                                    <div id="upload-placeholder" class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center w-full max-w-md">
                                        <span class="material-symbols-outlined text-4xl text-gray-400">cloud_upload</span>
                                        <p class="mt-2 text-gray-500">Upload an image for medical analysis</p>
                                    </div>
                                </div>
                                
                                <div id="label-container" style="display: none;">
                                    <div id="topPrediction" class="p-4 rounded-lg mb-4 bg-gradient-to-r from-purple-500 to-indigo-600 text-white font-semibold"></div>
                                    <div class="analysis-section bg-gray-50 rounded-xl p-4">
                                        <h3 class="text-lg font-semibold mb-3 flex items-center">
                                            <span class="material-symbols-outlined mr-2">analytics</span>
                                            Confidence Analysis
                                        </h3>
                                        <div id="predictions-display"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 5: Why AarogyaLink -->
    <section id="why-us" class="py-20 md:py-32" style="background-color: var(--md-sys-color-surface-variant);">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="md:text-center max-w-2xl md:mx-auto">
                <h2 class="text-[var(--md-sys-color-on-surface)]">Health is a Partnership. We're Here to Help.</h2>
            </div>
            
            <div class="mt-16 grid grid-cols-1 md:grid-cols-3 gap-12 text-center">
                <div class="p-8 rounded-[28px] m3-card">
                    <h4 class="text-2xl font-bold" style="color: var(--md-sys-color-on-surface);">24/7 Access</h4>
                    <p class="mt-4 text-[var(--md-sys-color-on-surface-variant)]">Healthcare that fits your schedule, not the other way around. Get answers whenever you need them.</p>
                </div>
                <div class="p-8 rounded-[28px] m3-card">
                    <h4 class="text-2xl font-bold" style="color: var(--md-sys-color-on-surface);">Privacy & Security</h4>
                    <p class="mt-4 text-[var(--md-sys-color-on-surface-variant)]">Your health data is protected with bank-level encryption. Your privacy is our top priority.</p>
                </div>
                <div class="p-8 rounded-[28px] m3-card">
                    <h4 class="text-2xl font-bold" style="color: var(--md-sys-color-on-surface);">Expert Guidance</h4>
                    <p class="mt-4 text-[var(--md-sys-color-on-surface-variant)]">Connect with a network of verified healthcare professionals for trustworthy advice.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 6: Contact Form -->
    <section id="contact" class="py-20 md:py-32">
        <div class="max-w-xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="text-[var(--md-sys-color-on-surface)]">Get In Touch</h2>
            <p class="mt-4 text-lg text-[var(--md-sys-color-on-surface-variant)]">
                For all non-medical inquiries, please fill out the form below.
            </p>
            <form id="contactForm" class="mt-12 space-y-6">
                <input type="text" id="contactName" placeholder="Your Name" class="w-full m3-input" required>
                <input type="email" id="contactEmail" placeholder="Your Email" class="w-full m3-input" required>
                <textarea id="contactMessage" rows="4" placeholder="Your Message" class="w-full m3-input" required></textarea>
                <button type="submit" class="w-full px-6 py-3 m3-button shadow-lg">
                    Send Message
                </button>
            </form>
        </div>
    </section>

    <!-- Section 7: Footer -->
    <footer style="background-color: var(--md-sys-color-surface-container); color: var(--md-sys-color-on-surface);" class="py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p>&copy; 2024 AarogyaLink. All rights reserved.</p>
            <div class="mt-4 space-x-4 text-sm" style="color: var(--md-sys-color-on-surface-variant);">
                <a href="#" class="hover:text-[var(--md-sys-color-on-surface)] transition-colors duration-200">Privacy Policy</a>
                <a href="#" class="hover:text-[var(--md-sys-color-on-surface)] transition-colors duration-200">Terms of Service</a>
            </div>
        </div>
    </footer>

    <!-- Floating Get Started Button -->
    <a href="#chat" class="floating-cta" id="floatingCTA">
        <span class="material-symbols-outlined">healing</span>
        <span>Get Started</span>
    </a>

    <!-- Floating Get Started Button -->
    <div class="floating-cta" id="floatingCTA">
        <button onclick="scrollToChat()" class="floating-cta-button">
            <span class="material-symbols-outlined">health_and_safety</span>
            <span>Get Started</span>
        </button>
    </div>

    <!-- Floating Image Diagnosis Button -->
    <a href="/teach" target="_blank" class="floating-image-diagnosis" id="floatingImageDiagnosis" title="Upload medical images or use camera for AI-powered diagnosis">
        <span class="material-symbols-outlined">camera_alt</span>
        <span>Image Diagnosis</span>
    </a>

    <!-- JavaScript for Interactive Features -->
    <script>
        const API_BASE_URL = 'http://localhost:5000';
        let isRecording = false;
        let mediaRecorder = null;
        let recordingTimer = null;
        let recordingStartTime = 0;
        let audioChunks = [];

        // Theme Toggle Functionality
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            console.log('Initializing theme:', savedTheme);
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            updateThemeToggleButton(savedTheme);
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            console.log('Toggling theme from', currentTheme, 'to', newTheme);
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            updateThemeToggleButton(newTheme);
            
            // Dispatch a custom event for other components to listen to theme changes
            window.dispatchEvent(new CustomEvent('themeChanged', { detail: newTheme }));
        }
    
    function updateThemeToggleButton(theme) {
        const themeIcon = document.getElementById('themeIcon');
        const themeText = document.getElementById('themeText');
        
        if (themeIcon && themeText) {
            if (theme === 'dark') {
                themeIcon.textContent = 'light_mode';
                themeText.textContent = 'Light';
            } else {
                themeIcon.textContent = 'dark_mode';
                themeText.textContent = 'Dark';
            }
        }
    }

    // Voice Input Functionality
    let isVoiceRecording = false;
    let recognition = null;
    let autoSendVoice = false; // Don't auto-send voice input to Gemini - just convert to text (kept for compatibility)
    
    // Initialize speech recognition - make it globally available
    function initializeSpeechRecognition() {
        console.log('Initializing speech recognition...');
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            console.log('Speech recognition API is available');
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';
            
            recognition.onstart = function() {
                console.log('Voice recognition started');
                isVoiceRecording = true;
                updateVoiceButtonState();
                addMessage('🎤 Listening... Please speak clearly.', false);
            };
            
            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                console.log('Voice input:', transcript);
                
                const messageInput = document.getElementById('messageInput');
                if (messageInput) {
                    // Set the transcript as the input value
                    messageInput.value = transcript;
                    
                    // Show success message
                    addMessage('✅ Voice input received and converted to text. Click the send button to process with Gemini AI.', false);
                }
            };
            
            recognition.onerror = function(event) {
                console.error('Speech recognition error:', event.error);
                isVoiceRecording = false;
                updateVoiceButtonState();
                
                let errorMessage = 'Voice recognition error: ';
                switch(event.error) {
                    case 'no-speech':
                        errorMessage += 'No speech detected. Please try again.';
                        break;
                    case 'audio-capture':
                        errorMessage += 'No microphone found. Please check your microphone.';
                        break;
                    case 'not-allowed':
                        errorMessage += 'Microphone access denied. Please allow microphone access.';
                        break;
                    case 'network':
                        errorMessage += 'Network error. Please check your connection.';
                        break;
                    default:
                        errorMessage += event.error;
                }
                
                addMessage(errorMessage, false);
            };
            
            recognition.onend = function() {
                console.log('Voice recognition ended');
                isVoiceRecording = false;
                updateVoiceButtonState();
            };
        } else {
            console.warn('Speech recognition not supported in this browser');
            // Hide voice button if not supported
            const voiceBtn = document.getElementById('voiceInputBtn');
            if (voiceBtn) {
                voiceBtn.style.display = 'none';
            }
        }
    }
    
    // Toggle voice input - make it globally available
    function toggleVoiceInput() {
        console.log('toggleVoiceInput called. Recognition object:', recognition);
        if (!recognition) {
            console.log('Recognition object not available');
            addMessage('Voice recognition not supported in your browser. Please use Chrome, Edge, or Safari.', false);
            return;
        }
        
        if (isVoiceRecording) {
            console.log('Stopping voice recognition');
            recognition.stop();
        } else {
            console.log('Starting voice recognition');
            try {
                recognition.start();
            } catch (error) {
                console.error('Error starting voice recognition:', error);
                addMessage('Error starting voice recognition. Please try again.', false);
            }
        }
    }
    
    // Send voice message to Gemini
    async function sendVoiceMessageToGemini(transcript) {
        if (!transcript || transcript.trim() === '') return;
        
        // Clear the input field
        const messageInput = document.getElementById('messageInput');
        if (messageInput) {
            messageInput.value = '';
        }
        
        // Add user message with voice indicator
        addMessage(`🎤 ${transcript}`, true);
        
        // Add loading message with more specific information
        const loadingMessage = addMessage('🤖 Processing your voice input with Gemini AI... This may take a few seconds.', false, true);
        
        try {
            const response = await fetch(`${API_BASE_URL}/api/chat`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ 
                    message: transcript,
                    source: 'voice' // Add source indicator for analytics
                })
            });
            
            const data = await response.json();
            
            // Remove loading message
            loadingMessage.remove();
            
            if (data.success) {
                addMessage(data.response);
                
                // Add special indicator for voice responses
                if (data.input_source === 'voice') {
                    console.log('Voice query processed successfully with', data.source, 'API');
                }
            } else {
                addMessage('Sorry, I encountered an error processing your voice input. Please try again.');
            }
        } catch (error) {
            loadingMessage.remove();
            addMessage('Sorry, I\'m having trouble connecting to process your voice input. Please check if the backend server is running.');
        }
    }
    
    // Make functions globally available immediately after definition
    window.toggleVoiceInput = toggleVoiceInput;
    window.initializeSpeechRecognition = initializeSpeechRecognition;
    window.sendVoiceMessageToGemini = sendVoiceMessageToGemini;
    
    // Update voice button visual state
    function updateVoiceButtonState() {
        const voiceBtn = document.getElementById('voiceInputBtn');
        const micIcon = voiceBtn?.querySelector('.material-symbols-outlined');
        
        if (voiceBtn && micIcon) {
            if (isVoiceRecording) {
                voiceBtn.classList.add('recording');
                voiceBtn.title = 'Click to stop recording';
                micIcon.textContent = 'mic';
            } else {
                voiceBtn.classList.remove('recording');
                voiceBtn.title = 'Click to speak';
                micIcon.textContent = 'mic';
            }
        }
    }

    // Test backend connection
    async function testBackendConnection() {
        try {
            console.log('🔗 Testing backend connection...');
            const response = await fetch(`${API_BASE_URL}/health`, { timeout: 5000 });
            const data = await response.json();
            console.log('✅ Backend connected successfully:', data);
        } catch (error) {
            console.error('❌ Backend connection failed:', error);
            console.log('💡 Make sure the Flask server is running on port 5000');
        }
    }

    // Initialize Teachable Machine model automatically
    async function initializeTeachableMachine() {
        try {
            console.log('🤖 Initializing Teachable Machine model...');
            await initTeachableMachine();
        } catch (error) {
            console.error('❌ Error initializing Teachable Machine:', error);
        }
    }

    // Initialize theme on page load
    document.addEventListener('DOMContentLoaded', function() {
        console.log('🚀 AarogyaLink initialized - DOM loaded');
        console.log('📱 User Agent:', navigator.userAgent);
        console.log('🌐 Current URL:', window.location.href);
        
        // Check browser capabilities
        console.log('🎤 getUserMedia supported:', !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia));
        console.log('📷 Camera API supported:', !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia));
        console.log('🔊 MediaRecorder supported:', typeof MediaRecorder !== 'undefined');
        console.log('🗣️ Speech Recognition supported:', !!(window.SpeechRecognition || window.webkitSpeechRecognition));
        
        // Initialize speech recognition
        console.log('Initializing speech recognition...');
        initializeSpeechRecognition();
        console.log('Speech recognition initialization complete');
        
        // Check for HTTPS (required for some browser features)
        if (location.protocol !== 'https:' && location.hostname !== 'localhost' && location.hostname !== '127.0.0.1') {
            console.warn('⚠️ HTTPS required for camera/microphone access on non-localhost domains');
        }
        
        initializeTheme();
        setupDragAndDrop('imageUploadArea', 'imageInput');
        initializeLanguage(); // Initialize language support
        
        // Test backend connectivity
        testBackendConnection();
        
        // Initialize Teachable Machine model REMOVED as per user request
        // initializeTeachableMachine();
    });
    
    // Add message function
    function addMessage(content, isUser = false, isLoading = false) {
        const chatContainer = document.getElementById('chatContainer');
        if (!chatContainer) return null;
        
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${isUser ? 'user' : 'ai'}${isLoading ? ' loading' : ''}`;
        
        // Create avatar
        const avatarDiv = document.createElement('div');
        avatarDiv.className = 'message-avatar';
        
        if (isUser) {
            avatarDiv.innerHTML = '<span class="material-symbols-outlined">person</span>';
        } else {
            avatarDiv.innerHTML = '<span class="material-symbols-outlined">health_and_safety</span>';
        }
        
        // Create bubble
        const bubbleDiv = document.createElement('div');
        bubbleDiv.className = 'message-bubble';
            
            if (isLoading) {
                // Add typing indicator for loading messages
                bubbleDiv.innerHTML = `
                    <div class="typing-indicator">

                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                    <span style="margin-left: 12px; font-style: italic; opacity: 0.8;">${content}</span>
                `;
            } else {
                // Add message content with enhanced formatting
                bubbleDiv.innerHTML = formatMessageContent(content);
            }
            
            messageDiv.appendChild(avatarDiv);
            messageDiv.appendChild(bubbleDiv);
            chatContainer.appendChild(messageDiv);
            
            // Smooth scroll to bottom
            chatContainer.scrollTo({
                top: chatContainer.scrollHeight,
                behavior: 'smooth'
                });
            
            return messageDiv;
        }
        
        // Format message content with better styling
        function formatMessageContent(content) {
            // Convert line breaks to proper HTML
            let formatted = content.replace(/\n/g, '<br>');
            
            // Style numbered lists
            formatted = formatted.replace(/(\d+\.)\s/g, '<strong>$1</strong> ');
            
            // Style questions (lines ending with ?)
            formatted = formatted.replace(/([^<>]*\?)/g, '<em style="color: var(--md-sys-color-primary);">$1</em>');
            
            // Style important medical terms
            const medicalTerms = ['symptoms', 'diagnosis', 'treatment', 'medication', 'doctor', 'healthcare', 'medical'];
            medicalTerms.forEach(term => {
                const regex = new RegExp(`\\b(${term})\\b`, 'gi');
                formatted = formatted.replace(regex, '<span style="font-weight: 600; color: var(--md-sys-color-primary);">$1</span>');
            });
            
            return formatted;
        }

        // Enhanced text message sending
        async function sendTextMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addMessage(message, true);
            input.value = '';
            
            // Add loading message
            const loadingMessage = addMessage('Let me analyze your symptoms and ask some follow-up questions...', false, true);
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/chat`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message: message })
                });
                
                const data = await response.json();
                
                // Remove loading message
                loadingMessage.remove();
                
                if (data.success) {
                    addMessage(data.response);
                } else {
                    addMessage('Sorry, I encountered an error. Please try again.');
                }
            } catch (error) {
                loadingMessage.remove();
                addMessage('Sorry, I\'m having trouble connecting. Please check if the backend server is running.');
            }
        }
        
        // Tab switching function - make it globally available
        window.switchTab = function(tabName) {
            console.log('switchTab called with:', tabName);
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Add active class to selected tab
            const selectedTab = document.querySelector(`[onclick="switchTab('${tabName}')"]`);
            if (selectedTab) {
                selectedTab.classList.add('active');
                console.log('Added active class to tab:', selectedTab);
            } else {
                console.log('Tab not found for:', tabName);
            }
            
            // Add active class to selected tab content
            const selectedContent = document.getElementById(`${tabName}-tab`);
            if (selectedContent) {
                selectedContent.classList.add('active');
                console.log('Added active class to content:', selectedContent);
            } else {
                console.log('Content not found for:', `${tabName}-tab`);
            }
        }
        
        // Voice functions moved to global scope to fix ReferenceError
        
        
        // Quick prompt function
        function setQuickPrompt(type) {
            const input = document.getElementById('messageInput');
            const prompts = {
                'headache': 'I have a headache. It started [when?] and feels like [describe the pain]. The pain level is [1-10]. I have also been experiencing [any other symptoms?].',
                'fever': 'I have a fever. My temperature is [if known] and I\'ve been feeling feverish since [when?]. I also have [other symptoms like chills, aches, etc.].',
                'stomach': 'I have stomach pain. It started [when?] and is located [where exactly?]. The pain is [sharp/dull/cramping] and rated [1-10]. I last ate [when and what?].',
                'cough': 'I have been coughing since [when?]. The cough is [dry/wet/with phlegm]. I also have [other symptoms like sore throat, congestion, etc.].',
                'fatigue': 'I have been feeling very tired and fatigued since [when?]. I sleep [how many hours?] and wake up feeling [rested/tired]. I also notice [other symptoms?].',
                'injury': 'I have an injury/pain in my [body part]. It happened [when and how?]. The pain level is [1-10] and feels like [describe]. I can/cannot [move/use it normally].'
            };
            
            input.value = prompts[type] || '';
            input.focus();
            
            // Auto-resize textarea
            input.style.height = 'auto';
            input.style.height = input.scrollHeight + 'px';
        }

        // Handle textarea key press (Ctrl/Cmd + Enter to send)
        function handleTextareaKeyPress(event) {
            if ((event.ctrlKey || event.metaKey) && event.key === 'Enter') {
                event.preventDefault();
                sendTextMessage();
            }
        }

        // Legacy function for backward compatibility
        async function sendMessage() {
            await sendTextMessage();
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendTextMessage();
            }
        }

        // Enhanced image upload handling
        async function handleImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Show preview
            const previewArea = document.getElementById('imagePreviewArea');
            const preview = document.getElementById('imagePreview');
            
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
                previewArea.style.display = 'block';
            };
            reader.readAsDataURL(file);
            
            // Store file for later submission
            preview.uploadedFile = file;
        }

        async function submitImageAnalysis() {
            const preview = document.getElementById('imagePreview');
            const description = document.getElementById('imageDescription').value.trim();
            const file = preview.uploadedFile;
            
            if (!file) {
                alert('Please select an image first.');
                return;
            }
            
            addMessage(`Uploaded image: ${file.name}${description ? ` - ${description}` : ''}`, true);
            
            const loadingMessage = addMessage('Analyzing your image...', false, true);
            
            const formData = new FormData();
            formData.append('file', file);
            formData.append('type', 'image');
            formData.append('description', description || 'Please analyze this medical image');
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/upload`, {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                loadingMessage.remove();
                
                if (data.success) {
                    addMessage(data.response);
                    clearImageUpload();
                } else {
                    addMessage('Sorry, I couldn\'t analyze the image. Please try again.');
                }
            } catch (error) {
                loadingMessage.remove();
                addMessage('Sorry, I\'m having trouble processing the image. Please check if the backend server is running.');
            }
        }

        function clearImageUpload() {
            document.getElementById('imageInput').value = '';
            document.getElementById('imagePreview').src = '';
            document.getElementById('imageDescription').value = '';
            document.getElementById('imagePreviewArea').style.display = 'none';
        }

        // Voice recording functionality with enhanced permission handling
        async function toggleRecording() {
            if (isRecording) {
                stopRecording();
            } else {
                await startRecording();
            }
        }

        async function startRecording() {
            try {
                // Check if getUserMedia is supported
                if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                    throw new Error('Your browser does not support audio recording. Please use a modern browser like Chrome, Firefox, or Edge.');
                }
                
                // Update UI to show requesting permission
                document.getElementById('voiceTitle').textContent = 'Requesting Microphone Access...';
                document.getElementById('voiceSubtitle').textContent = 'Please allow microphone access when prompted';
                
                console.log('Requesting microphone access...');
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    audio: {
                        echoCancellation: true,
                        noiseSuppression: true,
                        sampleRate: 44100
                    }
                });
                
                console.log('Microphone access granted');
                
                // Check if MediaRecorder is supported
                if (!MediaRecorder.isTypeSupported('audio/webm')) {
                    console.warn('audio/webm not supported, trying audio/mp4');
                    if (!MediaRecorder.isTypeSupported('audio/mp4')) {
                        console.warn('audio/mp4 not supported, using default');
                    }
                }
                
                const options = {
                    mimeType: MediaRecorder.isTypeSupported('audio/webm') ? 'audio/webm' : 'audio/mp4'
                };
                
                mediaRecorder = new MediaRecorder(stream, options);
                audioChunks = [];
                
                mediaRecorder.ondataavailable = function(event) {
                    if (event.data.size > 0) {
                        audioChunks.push(event.data);
                        console.log('Audio chunk received:', event.data.size, 'bytes');
                    }
                };
                
                mediaRecorder.onstop = function() {
                    console.log('Recording stopped, processing audio...');
                    const mimeType = mediaRecorder.mimeType || 'audio/webm';
                    const audioBlob = new Blob(audioChunks, { type: mimeType });
                    console.log('Audio blob created:', audioBlob.size, 'bytes');
                    processRecordedAudio(audioBlob);
                };
                
                mediaRecorder.onerror = function(event) {
                    console.error('MediaRecorder error:', event.error);
                    resetRecordingUI();
                    addMessage('Recording error occurred. Please try again.', false);
                };
                
                mediaRecorder.start(1000); // Collect data every second
                isRecording = true;
                
                console.log('Recording started');
                addMessage('🎤 Started recording audio...', false);
                
                // Update UI
                document.getElementById('voiceIcon').textContent = 'stop';
                document.getElementById('voiceTitle').textContent = 'Recording Your Message...';
                document.getElementById('voiceSubtitle').textContent = 'Speak clearly about your health concerns. Click stop when finished.';
                document.getElementById('recordButton').textContent = 'Stop Recording';
                document.getElementById('recordButton').style.backgroundColor = '#dc2626';
                document.getElementById('voiceRecordingArea').classList.add('recording');
                
                // Start timer
                recordingStartTime = Date.now();
                document.getElementById('recordingTimer').style.display = 'block';
                recordingTimer = setInterval(updateRecordingTimer, 1000);
                
            } catch (error) {
                console.error('Error starting recording:', error);
                resetRecordingUI();
                
                let errorMessage = 'Error accessing microphone. ';
                
                if (error.name === 'NotAllowedError') {
                    errorMessage += 'Microphone access was denied. Please check your browser settings and allow microphone access for this site.';
                } else if (error.name === 'NotFoundError') {
                    errorMessage += 'No microphone found. Please connect a microphone and try again.';
                } else if (error.name === 'NotSupportedError') {
                    errorMessage += 'Your browser does not support audio recording. Please use Chrome, Firefox, or Edge.';
                } else {
                    errorMessage += error.message || 'Please check your microphone and browser permissions.';
                }
                
                addMessage(errorMessage, false);
                alert(errorMessage);
            }
        }
        
        function resetRecordingUI() {
            document.getElementById('voiceIcon').textContent = 'mic';
            document.getElementById('voiceTitle').textContent = 'Record Your Message';
            document.getElementById('voiceSubtitle').textContent = 'Click to start recording your health concerns';
            document.getElementById('recordButton').textContent = 'Start Recording';
            document.getElementById('recordButton').style.backgroundColor = '';
            document.getElementById('voiceRecordingArea').classList.remove('recording');
            document.getElementById('recordingTimer').style.display = 'none';
            
            if (recordingTimer) {
                clearInterval(recordingTimer);
                recordingTimer = null;
            }
        }

        function stopRecording() {
            if (mediaRecorder && isRecording) {
                console.log('Stopping recording...');
                
                try {
                    mediaRecorder.stop();
                    
                    // Stop all media tracks
                    if (mediaRecorder.stream) {
                        mediaRecorder.stream.getTracks().forEach(track => {
                            track.stop();
                            console.log('Stopped track:', track.kind);
                        });
                    }
                    
                    isRecording = false;
                    addMessage('🎤 Recording stopped, processing audio...', false);
                    
                } catch (error) {
                    console.error('Error stopping recording:', error);
                    addMessage('Error stopping recording. Please try again.', false);
                }
                
                // Reset UI
                resetRecordingUI();
            }
        }

        function updateRecordingTimer() {
            const elapsed = Math.floor((Date.now() - recordingStartTime) / 1000);
            const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
            const seconds = (elapsed % 60).toString().padStart(2, '0');
            document.getElementById('recordingTimer').textContent = `${minutes}:${seconds}`;
        }

        async function processRecordedAudio(audioBlob) {
            if (!audioBlob || audioBlob.size === 0) {
                addMessage('Recording failed - no audio data captured. Please try again.', false);
                return;
            }
            
            console.log('Processing audio blob:', audioBlob.size, 'bytes, type:', audioBlob.type);
            addMessage(`Recorded voice message (${(audioBlob.size / 1024).toFixed(1)} KB)`, true);
            
            const loadingMessage = addMessage('🎵 Processing your voice message...', false, true);
            
            const formData = new FormData();
            
            // Use appropriate file extension based on mime type
            let fileName = 'recording.webm';
            if (audioBlob.type.includes('mp4')) {
                fileName = 'recording.mp4';
            } else if (audioBlob.type.includes('wav')) {
                fileName = 'recording.wav';
            }
            
            formData.append('file', audioBlob, fileName);
            formData.append('type', 'audio');
            formData.append('description', 'Voice message recording - health concerns');
            
            console.log('Sending audio to server:', fileName, audioBlob.type);
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/upload`, {
                    method: 'POST',
                    body: formData
                });
                
                console.log('Server response status:', response.status);
                
                if (!response.ok) {
                    throw new Error(`Server error: ${response.status} ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('Server response:', data);
                
                loadingMessage.remove();
                
                if (data.success) {
                    addMessage(data.response);
                } else {
                    addMessage(`Sorry, I couldn't process the voice message: ${data.error || 'Unknown error'}`);
                }
            } catch (error) {
                console.error('Error processing audio:', error);
                loadingMessage.remove();
                addMessage(`Sorry, I'm having trouble processing the voice message: ${error.message}. Please check if the backend server is running.`);
            }
        }

        // Audio file upload handling
        async function handleAudioUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            addMessage(`Uploaded audio: ${file.name}`, true);
            
            const loadingMessage = addMessage('Processing audio file...', false, true);
            
            const formData = new FormData();
            formData.append('file', file);
            formData.append('type', 'audio');
            formData.append('description', 'Audio file upload');
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/upload`, {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                loadingMessage.remove();
                
                if (data.success) {
                    addMessage(data.response);
                } else {
                    addMessage('Sorry, I couldn\'t process the audio file. Please try again.');
                }
            } catch (error) {
                loadingMessage.remove();
                addMessage('Sorry, I\'m having trouble processing the audio file. Please check if the backend server is running.');
            }
            
            // Reset file input
            event.target.value = '';
        }

        // Contact form functionality
        document.getElementById('contactForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const name = document.getElementById('contactName').value;
            const email = document.getElementById('contactEmail').value;
            const message = document.getElementById('contactMessage').value;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/contact`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ name, email, message })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    alert('Thank you for your message! We\'ll get back to you soon.');
                    this.reset();
                } else {
                    alert('Sorry, there was an error sending your message. Please try again.');
                }
            } catch (error) {
                alert('Sorry, I\'m having trouble sending your message. Please check if the backend server is running.');
            }
        });

        // Drag and drop functionality
        function setupDragAndDrop(elementId, inputId) {
            const element = document.getElementById(elementId);
            const input = document.getElementById(inputId);
            
            element.addEventListener('dragover', function(e) {
                e.preventDefault();
                element.classList.add('dragover');
            });
            
            element.addEventListener('dragleave', function(e) {
                e.preventDefault();
                element.classList.remove('dragover');
            });
            
            element.addEventListener('drop', function(e) {
                e.preventDefault();
                element.classList.remove('dragover');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    input.files = files;
                    input.dispatchEvent(new Event('change'));
                }
            });
        }
        
        // Teachable Machine variables
        let model = null;
        let maxPredictions = 0;
        let webcam = null;
        let webcamPlaying = false;
        const MODEL_BASE = "https://teachablemachine.withgoogle.com/models/ebiM39JYb/";

        // Teachable Machine Functions
        async function initTeachableMachine() {
            try {
                console.log('Initializing Teachable Machine...');
                console.log('Model URL:', MODEL_BASE + "model.json");
                console.log('Metadata URL:', MODEL_BASE + "metadata.json");
                
                const modelURL = MODEL_BASE + "model.json";
                const metadataURL = MODEL_BASE + "metadata.json";
                
                // Add timeout to prevent hanging
                const timeout = new Promise((_, reject) => 
                    setTimeout(() => reject(new Error('Model loading timeout after 30 seconds')), 30000)
                );
                
                console.log('Loading model...');
                const modelPromise = tmImage.load(modelURL, metadataURL);
                model = await Promise.race([modelPromise, timeout]);
                console.log('Model loaded successfully');
                
                maxPredictions = model.getTotalClasses();
                
                document.getElementById("status").innerText = "✅ Model: loaded and ready for analysis";
                console.log('Enhanced model loaded with', maxPredictions, 'classes');
                
                // Setup event listeners
                document.getElementById("startWebcamBtn").addEventListener("click", startWebcam);
                document.getElementById("stopWebcamBtn").addEventListener("click", stopWebcam);
                document.getElementById("uploadImageBtn").addEventListener("click", () => {
                    document.getElementById("imageUpload").click();
                });
                document.getElementById("imageUpload").addEventListener("change", predictImage);
            } catch (err) {
                document.getElementById("status").innerText = "❌ Model: failed to load (see console)";
                console.error("Failed loading model:", err);
                console.error("Error name:", err.name);
                console.error("Error message:", err.message);
                if (err.stack) {
                    console.error("Stack trace:", err.stack);
                }
                
                // Additional error handling
                if (err.message && err.message.includes('timeout')) {
                    console.error("Model loading timed out. Check network connection and model URL.");
                } else if (err.message && err.message.includes('Failed to fetch')) {
                    console.error("Network error while loading model. Check if the model URL is accessible.");
                }
            }
        }
        
        async function startWebcam() {
            try {
                if (!model) {
                    console.log("Model not loaded, initializing...");
                    await initTeachableMachine();
                }
                if (webcamPlaying) {
                    console.log("Webcam already playing");
                    return;
                }
                
                console.log("Initializing webcam...");
                webcam = new tmImage.Webcam(400, 300, true); 
                await webcam.setup();
                await webcam.play();
                document.getElementById("webcam-container").appendChild(webcam.canvas);
                webcamPlaying = true;
                document.getElementById("startWebcamBtn").disabled = true;
                document.getElementById("stopWebcamBtn").disabled = false;
                window.requestAnimationFrame(webcamLoop);
                document.getElementById("status").innerText = "📹 Webcam active - Model ready";
                console.log("Webcam started successfully");
            } catch (err) {
                console.error("Error starting webcam:", err);
                document.getElementById("status").innerText = "❌ Webcam: failed to start (see console)";
                console.error("Error name:", err.name);
                console.error("Error message:", err.message);
                console.error("Stack trace:", err.stack);
                
                // Additional debugging for common issues
                if (err.name === 'NotAllowedError') {
                    console.error("Camera permission denied. User must allow camera access.");
                } else if (err.name === 'NotFoundError') {
                    console.error("No camera found. Please connect a camera device.");
                } else if (err.name === 'NotSupportedError') {
                    console.error("Camera API not supported in this browser.");
                }
            }
        }
        
        function stopWebcam() {
            if (!webcam) return;
            webcam.stop();
            if (webcam.canvas && webcam.canvas.parentNode) {
                webcam.canvas.parentNode.removeChild(webcam.canvas);
            }
            webcamPlaying = false;
            document.getElementById("startWebcamBtn").disabled = false;
            document.getElementById("stopWebcamBtn").disabled = true;
        }
        
        async function webcamLoop() {
            if (!webcamPlaying) return;
            webcam.update();
            await predict(webcam.canvas);
            window.requestAnimationFrame(webcamLoop);
        }
        
        async function predict(inputElement) {
            if (!model) {
                console.warn("Model not loaded yet");
                document.getElementById("status").innerText = "⚠️ Model not loaded. Please wait or refresh the page.";
                return;
            }
            try {
                console.log('Starting prediction...');
                const prediction = await model.predict(inputElement);
                console.log('Prediction completed:', prediction);
                
                // Fill labels with radial progress bars
                const topPrediction = prediction.reduce((a, b) => (a.probability > b.probability ? a : b));
                
                // Update top prediction
                document.getElementById("topPrediction").innerHTML =
                  `<strong>🎯 Top Prediction:</strong> ${topPrediction.className} (${(topPrediction.probability * 100).toFixed(1)}% confidence)`;
                
                // Display all predictions with radial progress bars
                const predictionsDisplay = document.getElementById('predictions-display');
                predictionsDisplay.innerHTML = '';
                
                const horizontalContainer = document.createElement('div');
                horizontalContainer.className = 'predictions-horizontal flex flex-wrap gap-4 justify-center mt-4';
                
                // Sort predictions by confidence and take top 5
                const sortedPredictions = prediction
                  .sort((a, b) => b.probability - a.probability)
                  .slice(0, 5);
                
                sortedPredictions.forEach(pred => {
                    const percentage = Math.round(pred.probability * 100);
                    
                    const predictionItem = document.createElement('div');
                    predictionItem.className = 'prediction-item-horizontal flex flex-col items-center gap-2 p-3 bg-white rounded-xl border border-gray-200 min-w-[90px] transition-all hover:shadow-md';
                    
                    // Create radial progress bar
                    const radialProgress = document.createElement('div');
                    radialProgress.className = 'radial-progress relative w-20 h-20 rounded-full bg-[conic-gradient(#667eea_calc(var(--percentage)*1%),#e0e0e0_0)] flex items-center justify-center transition-all';
                    radialProgress.style.setProperty('--percentage', percentage);
                    
                    const radialInner = document.createElement('div');
                    radialInner.className = 'radial-progress-inner absolute w-16 h-16 rounded-full bg-white shadow-inner';
                    
                    const radialText = document.createElement('div');
                    radialText.className = 'radial-progress-text relative z-10 text-xs font-semibold text-gray-700 text-center';
                    radialText.textContent = `${percentage}%`;
                    
                    radialProgress.appendChild(radialInner);
                    radialProgress.appendChild(radialText);
                    
                    const label = document.createElement('div');
                    label.className = 'prediction-label-horizontal text-xs font-medium text-gray-700 text-center max-w-[80px] break-words';
                    label.textContent = pred.className;
                    
                    predictionItem.appendChild(radialProgress);
                    predictionItem.appendChild(label);
                    
                    horizontalContainer.appendChild(predictionItem);
                });
                
                predictionsDisplay.appendChild(horizontalContainer);
                
                // Show the results
                document.getElementById('label-container').style.display = 'block';
                console.log('Prediction results displayed');
            } catch (e) {
                console.error("Prediction error:", e);
                document.getElementById("status").innerText = "❌ Prediction error occurred (see console)";
                console.error("Error name:", e.name);
                console.error("Error message:", e.message);
                console.error("Stack trace:", e.stack);
            }
        }
        
        async function predictImage(event) {
            try {
                const file = (event && event.target && event.target.files && event.target.files[0]) || null;
                if (!file) {
                    console.warn("No file selected");
                    return;
                }
                if (!model) {
                    console.log("Model not loaded, initializing...");
                    await initTeachableMachine();
                }
                
                // Hide placeholder and show image container
                document.getElementById('upload-placeholder').style.display = 'none';
                
                const img = document.createElement("img");
                img.className = "max-w-full max-h-64 rounded-xl shadow-md";
                img.src = URL.createObjectURL(file);
                img.onload = async () => {
                    try {
                        const c = document.getElementById("uploaded-image-container");
                        c.innerHTML = "";
                        c.appendChild(img);
                        await predict(img);
                        URL.revokeObjectURL(img.src);
                    } catch (e) {
                        console.error("Error during image prediction:", e);
                        document.getElementById("status").innerText = "❌ Image prediction error (see console)";
                    }
                };
                img.onerror = function() {
                    console.error("Error loading image file");
                    document.getElementById("status").innerText = "❌ Error loading image file";
                    URL.revokeObjectURL(this.src);
                };
            } catch (e) {
                console.error("Error in predictImage function:", e);
                document.getElementById("status").innerText = "❌ Error processing image (see console)";
            }
        }

        // Initialize drag and drop - removed duplicate DOMContentLoaded
        // (already handled in the theme initialization section above)

        // Initialize Teachable Machine model automatically
        async function initializeTeachableMachine() {
            try {
                console.log('🤖 Initializing Teachable Machine model...');
                // Model initialization removed as per user request
            } catch (error) {
                console.error('❌ Error initializing Teachable Machine:', error);
            }
        }

    </script>
    
    <!-- TensorFlow and Teachable Machine Scripts REMOVED -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script> -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script> -->

</body>
</html>